# 3.3.7 공유자원과 임계영역

### | 공유자원 (shared resource)

시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 의미한다.

<b> _경쟁 상태 (race condition)_ </b>

- 이 공유자원을 두 개 이상의 프로세스가 동시에 읽거나 쓰는 상황을 가리킨다.
- 동시에 접근을 시도할 때, 접근 타이밍이나 순서가 결과값에 영향을 줄 수 있다.

<br />

### | 임계영역 (critical section)

둘 이상의 프로세스, 스레드가 공유 자원에 접근할 때 순서 등의 이유로 결과가 달라지는 코드 영역을 말한다.

이를 해결하기 위해 lock 매커니즘을 사용하며, 종류는 다음과 같다.

> DB에 친숙하신 분이라면 트랜잭션 시, 처리의 순차성을 보장하기 위해 DBlock 사용하는 것을 떠올리면 좋을듯 !

<b> _뮤텍스(mutex)_ </b>

잠금 매커니즘이다.

프로세스나 스레드가 공유자원을 `lock()`을 통해 잠금설정하고, 사용한 후 `unlock()`을 통해 잠금 해제하는 객체이다.

<b> _세마포어(semaphore)_ </b>

신호 매커니즘으로, 일반화된 뮤텍스이다.

> 핸드폰으로 노래 재생 중에 전화가 오면, 노래가 중지되고 통화 작업 실행 -> 통화 종료되면 다시 노래 실행

간단한 정수값과 두 가지 함수(`wait`과 `signal`)로 공유자원에 대한 접근을 처리한다.

- `wait()`은 자신의 차례가 올 때 까지 기다리는 함수이며, 프로세스나 스레드가 공유자원에 접근 시 수행한다.

- 공유자원 해제 시 `signal()`을 수행하여 다음 프로세스로 순서를 넘겨준다.

바이너리 세마포어는 0과 1의 두가지 값을, 카운팅 세마포어는 여러 개의 값을 사용하여 접근을 제어한다.

(뮤텍스는 바이너리 세마포어임)

<b> _모니터 (monitor)_ </b>

둘 이상의 프로세스나 스레드가 공유 자원에 안전하게 접근할 수 있또록 공유자원을 숨기고, 인터페이스만 제공한다.

이는 뮤텍스를 편의성 증진을 목적으로 프로그래밍 언어 혹은 프레임워크 차원에서 제공되며, java의 경우 `synchronized` 키워드/C#의 경우 `lock` 키워드가 모니터 기능을 한다.
